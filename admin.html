<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏• - ‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <header class="bg-blue-600 text-white p-4 rounded-lg shadow-md mb-6">
            <h1 class="text-2xl font-bold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏• - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h1>
            <p class="text-sm">‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô Google Sheet ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
        </header>

        <main class="bg-white rounded-lg shadow-md p-6">
            <!-- Google Sheet Helper -->
            <section class="mb-6">
                <div class="p-4 bg-yellow-50 border-l-4 border-yellow-500 mb-4">
                    <h3 class="font-semibold text-yellow-800">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                    <p class="text-sm text-yellow-700 mt-1">
                        1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á (‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)<br>
                        2. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á<br>
                        3. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheet"<br>
                        4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô<br>
                        5. ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Google Sheet ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì<br>
                    </p>
                </div>
                
                <!-- Data Format Selection -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                    <div class="flex space-x-4">
                        <label class="inline-flex items-center">
                            <input type="radio" name="dataFormat" value="borehole" checked class="form-radio text-blue-600" onchange="toggleDataFormat('borehole')">
                            <span class="ml-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏• (‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏£‡∏¥‡∏á)</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="dataFormat" value="location" class="form-radio text-green-600" onchange="toggleDataFormat('location')">
                            <span class="ml-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</span>
                        </label>
                    </div>
                </div>
                
                    <div class="flex space-x-2">
                        <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vSn30i6fduRSszPNUwWskmwK8-KKunVtFfqGAyyFBAzXWJx5C0uz_6iLhai-F2rdwFOxlGMNdEU2uT_/edit" target="_blank" class="bg-green-500 hover:bg-green-600 text-white font-medium py-1 px-3 rounded text-sm">
                            ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google Sheet ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                        </a>
                        <a href="index.html" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded text-sm">
                            ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
                        </a>
                    </div>
            </section>

            <!-- Data Format Selector -->
            <section class="mb-6 border-t pt-4">
                <h2 class="text-xl font-semibold mb-4">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                <div class="flex gap-3">
                    <button id="selectBoreholeFormat" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 font-medium flex-1">
                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•
                    </button>
                    <button id="selectLocationFormat" class="px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 font-medium flex-1">
                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô)
                    </button>
                </div>
                <p class="text-sm text-gray-600 mt-2">
                    <span class="font-semibold">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•:</span> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î, ‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å ‡πÅ‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô<br>
                    <span class="font-semibold">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:</span> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô, ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç, ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏Ø‡∏•‡∏Ø
                </p>
            </section>

            <!-- Data Output Section -->
            <section class="mb-6 border-t pt-4">
                <h2 class="text-xl font-semibold mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheet</h2>
                <div class="space-y-4">
                    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Sheet CSV -->
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded mb-4">
                        <label for="sheetUrl" class="block text-sm font-medium text-blue-800 mb-1">URL ‡∏Ç‡∏≠‡∏á Google Sheet CSV ‡∏´‡∏•‡∏±‡∏Å (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô)</label>
                        <div class="flex">
                            <input type="text" id="sheetUrl" class="flex-grow p-2 border rounded text-sm" 
                                placeholder="https://docs.google.com/spreadsheets/d/.../export?format=csv&gid=0">
                            <button id="saveSheetUrl" class="ml-2 bg-blue-500 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL
                            </button>
                        </div>
                        <p class="text-xs text-blue-600 mt-1">
                            URL ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î, ‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏à‡∏π‡∏î, ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å, ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥)
                        </p>
                    </div>
                    
                    <div class="p-3 bg-green-50 border border-green-200 rounded">
                        <label for="soilSheetUrl" class="block text-sm font-medium text-green-800 mb-1">URL ‡∏Ç‡∏≠‡∏á Google Sheet CSV ‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô (‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)</label>
                        <div class="flex">
                            <input type="text" id="soilSheetUrl" class="flex-grow p-2 border rounded text-sm" 
                                placeholder="https://docs.google.com/spreadsheets/d/.../export?format=csv&gid=1">
                            <button id="saveSoilSheetUrl" class="ml-2 bg-green-500 hover:bg-green-700 text-white px-3 py-1 rounded text-sm">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL
                            </button>
                        </div>
                        <p class="text-xs text-green-600 mt-1">
                            URL ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô (‡∏ä‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏ô, ‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å, ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î, ‡∏™‡∏µ, pH)
                        </p>
                    </div>
                    
                    <!-- ‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô -->
                    <div class="p-3 bg-gray-50 border rounded">
                        <label for="generatedData" class="block text-sm font-medium text-gray-700 mb-1">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google Sheet)</label>
                        <textarea id="generatedData" rows="4" class="w-full p-2 border rounded text-sm font-mono" readonly placeholder="‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
                    </div>
                    <div class="flex space-x-2">
                        <button id="generateCSV" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                            ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheet
                        </button>
                        <button id="copyCSV" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
                            ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button id="copyAndOpenSheet" class="bg-purple-500 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded">
                            ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å + ‡πÄ‡∏õ‡∏¥‡∏î Google Sheet
                        </button>
                        <button id="clearForm" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded">
                            ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
                        </button>
                    </div>
                </div>
            </section>

            <!-- Form for adding new groundwater point -->
            <form id="groundwaterForm" class="border-t pt-4">
                <h2 class="text-xl font-semibold mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏∏‡∏î‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•‡πÉ‡∏´‡∏°‡πà</h2>
                
                <!-- Location details -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="latitude" class="block text-sm font-medium text-gray-700">‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î</label>
                        <input type="number" step="0.0000001" id="latitude" name="latitude" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label for="longitude" class="block text-sm font-medium text-gray-700">‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏à‡∏π‡∏î</label>
                        <input type="number" step="0.0000001" id="longitude" name="longitude" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label for="boreholeId" class="block text-sm font-medium text-gray-700">‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠</label>
                        <div class="flex space-x-2">
                            <div class="w-1/3">
                                <select id="boreholeSeries" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                                    <option value="SRN">SRN</option>
                                    <option value="NKT">NKT</option>
                                    <option value="PCB">PCB</option>
                                    <option value="CMI">CMI</option>
                                    <option value="KKN">KKN</option>
                                    <option value="custom">‡∏≠‡∏∑‡πà‡∏ô‡πÜ...</option>
                                </select>
                            </div>
                            <div class="w-2/3">
                                <div class="flex items-center">
                                    <span id="boreholePrefix" class="mr-1 text-gray-500">SRN-</span>
                                    <input type="text" id="boreholeNumber" 
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"
                                        placeholder="1027">
                                </div>
                                <input type="hidden" id="boreholeId" name="boreholeId" required>
                            </div>
                        </div>
                        <div class="mt-1">
                            <button type="button" id="checkBoreholeButton" class="text-sm text-blue-600 hover:text-blue-800">
                                ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
                            </button>
                        </div>
                        <div id="existingBoreholeContainer" class="mt-2 hidden">
                            <div class="bg-gray-50 rounded p-2 max-h-28 overflow-y-auto">
                                <p class="text-sm font-medium mb-1">‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß:</p>
                                <div id="existingBoreholes" class="text-xs grid grid-cols-3 gap-1"></div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label for="totalDepth" class="block text-sm font-medium text-gray-700">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏°‡∏ï‡∏£)</label>
                        <input type="number" step="0.1" id="totalDepth" name="totalDepth" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label for="waterLevel" class="block text-sm font-medium text-gray-700">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏• (‡πÄ‡∏°‡∏ï‡∏£)</label>
                        <input type="number" step="0.1" id="waterLevel" name="waterLevel" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                </div>
                
                <!-- Soil Layers -->
                <div class="border rounded-md p-4 mb-6">
                    <h3 class="font-semibold mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô</h3>
                    <div id="soilLayers">
                        <!-- Soil Layer 1 -->
                        <div class="soil-layer border-b pb-4 mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-medium">‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 1</h4>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô</label>
                                    <input type="text" name="soilName1" required
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"
                                        placeholder="‡∏î‡∏¥‡∏ô‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å</label>
                                    <input type="text" name="soilDepth1" required
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"
                                        placeholder="0-8 ‡∏°.">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                                    <input type="text" name="soilDesc1"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"
                                        placeholder="‡∏î‡∏¥‡∏ô‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÅ‡∏î‡∏á">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">‡∏™‡∏µ (hex ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏µ)</label>
                                    <div class="flex items-center space-x-2">
                                        <input type="color" name="soilColorPicker1" value="#D2B48C" 
                                            class="h-10 w-12 rounded-md border-gray-300 shadow-sm">
                                        <input type="text" name="soilColor1" value="#D2B48C" required
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">‡∏Ñ‡πà‡∏≤ pH</label>
                                    <input type="number" step="0.1" name="soilPH1" required
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"
                                        placeholder="7.0">
                                </div>
                            </div>
                        </div>

                        <!-- Template for additional layers will be added via JavaScript -->
                    </div>
                    
                    <button type="button" id="addLayer" class="mt-2 bg-green-500 hover:bg-green-700 text-white font-bold py-1 px-3 rounded text-sm">
                        + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô
                    </button>
                </div>
                
                <div class="flex justify-end space-x-2">
                    <button type="reset" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded">
                        ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                </div>
            </form>

            <!-- Form for general location data (hidden by default) -->
            <form id="locationForm" class="border-t pt-4 hidden">
                <h2 class="text-xl font-semibold mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô)</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="taskName" class="block text-sm font-medium text-gray-700">‡∏á‡∏≤‡∏ô</label>
                        <input type="text" id="taskName" name="taskName" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label for="priority" class="block text-sm font-medium text-gray-700">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
                        <select id="priority" name="priority" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                            <option value="P0">P0</option>
                            <option value="P1">P1</option>
                            <option value="P2">P2</option>
                            <option value="P3">P3</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="owner" class="block text-sm font-medium text-gray-700">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</label>
                        <input type="text" id="owner" name="owner" 
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label for="taskStatus" class="block text-sm font-medium text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                        <select id="taskStatus" name="taskStatus" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                            <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</option>
                            <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                            <option value="‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å">‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</option>
                            <option value="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="startDate" class="block text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                        <input type="date" id="startDate" name="startDate"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label for="endDate" class="block text-sm font-medium text-gray-700">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label>
                        <input type="date" id="endDate" name="endDate"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                </div>
                
                <div class="grid grid-cols-1 mb-4">
                    <div>
                        <label for="reason" class="block text-sm font-medium text-gray-700">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
                        <textarea id="reason" name="reason" rows="2"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"></textarea>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 mb-4">
                    <div>
                        <label for="notes" class="block text-sm font-medium text-gray-700">‡πÇ‡∏ô‡πâ‡∏ï</label>
                        <textarea id="notes" name="notes"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-2">
                    <button type="reset" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded">
                        ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </button>
                </div>
            </form>

            <!-- Data Format Explanation -->
            <section id="dataFormatExplanation" class="mb-6 border-t pt-4 hidden">
                <h2 class="text-xl font-semibold mb-2">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
                <div class="p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
                    <p class="text-sm text-blue-700">
                        ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà 1 (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•): ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏£‡∏¥‡∏á<br>
                        ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà 2 (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ): ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡πÇ‡∏î‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                    </p>
                </div>
            </section>

            <!-- Direct Paste Section -->
            <section class="mb-6 border-t pt-4">
                <h2 class="text-xl font-semibold mb-2">‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheet ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á</h2>
                <div class="space-y-4">
                    <div class="p-4 bg-yellow-50 border-l-4 border-yellow-600 rounded-r">
                        <p class="font-medium">‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheet ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á:</p>
                        <ol class="list-decimal list-inside text-sm pl-2 mt-2">
                            <li>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</li>
                            <li>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheet"</li>
                            <li>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î Google Sheet"</li>
                            <li>‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏Ç‡∏ß‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Paste" ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î Ctrl+V (‡∏´‡∏£‡∏∑‡∏≠ Command+V ‡∏ö‡∏ô Mac)</li>
                        </ol>
                    </div>
                    
                    <button id="copyAndOpenSheet" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded w-full flex items-center justify-center">
                        <span class="mr-2">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î Google Sheet</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                        </svg>
                    </button>
                </div>
            </section>

            <!-- ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Google Sheet -->
            <div class="p-4 bg-green-50 border-l-4 border-green-500 mb-4">
                <h3 class="font-semibold text-green-800">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô Google Sheet</h3>
                <ol class="text-sm text-green-700 mt-2 space-y-1">
                    <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1:</strong> ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á (‡πÅ‡∏ó‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</li>
                    <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2:</strong> ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheet"</li>
                    <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3:</strong> ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î Google Sheet"</li>
                    <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4:</strong> ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google Sheet ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Ctrl+V ‡∏´‡∏£‡∏∑‡∏≠ Cmd+V) ‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á</li>
                    <li><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5:</strong> ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà index.html ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</li>
                </ol>
                <div class="mt-3 p-2 bg-green-100 rounded text-xs">
                    <strong>üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö:</strong> ‡∏´‡∏≤‡∏Å‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ñ‡∏ß ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡∏•‡∏∞‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Google Sheet ‡∏ó‡∏µ‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                </div>
            </div>
        </main>

        <footer class="mt-6 text-center text-sm text-gray-600">
            <p>¬© 2025 ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•</p>
        </footer>
    </div>

    <script>
        // Global variables
        let currentDataFormat = 'borehole';
        let layerCount = 1;
        
        // Format a value for CSV, adding quotes if needed
        function formatForCSV(value) {
            if (value === null || value === undefined) {
                return '';
            }
            
            const stringValue = String(value);
            // If value contains comma, newline, or quotes, wrap in quotes and escape any quotes
            if (stringValue.includes(',') || stringValue.includes('\n') || stringValue.includes('"')) {
                return `"${stringValue.replace(/"/g, '""')}"`;
            }
            return stringValue;
        }
        
        // Add a new soil layer
        function addSoilLayer() {
            layerCount++;
            const layersContainer = document.getElementById('soilLayers');
            
            const newLayer = document.createElement('div');
            newLayer.className = 'soil-layer border-b pb-4 mb-4';
            newLayer.innerHTML = `
                <div class="flex justify-between items-center mb-2">
                    <h4 class="font-medium">‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà ${layerCount}</h4>
                    <button type="button" class="remove-layer text-red-500 hover:text-red-700">
                        ‡∏•‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏µ‡πâ
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô</label>
                        <input type="text" name="soilName${layerCount}" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å</label>
                        <input type="text" name="soilDepth${layerCount}" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                        <input type="text" name="soilDesc${layerCount}"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏™‡∏µ (hex ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏µ)</label>
                        <div class="flex items-center space-x-2">
                            <input type="color" name="soilColorPicker${layerCount}" value="#CCCCCC" 
                                class="h-10 w-12 rounded-md border-gray-300 shadow-sm">
                            <input type="text" name="soilColor${layerCount}" value="#CCCCCC" required
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">‡∏Ñ‡πà‡∏≤ pH</label>
                        <input type="number" step="0.1" name="soilPH${layerCount}" required
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                    </div>
                </div>
            `;
            
            layersContainer.appendChild(newLayer);
            
            // Add event listener to remove button
            newLayer.querySelector('.remove-layer').addEventListener('click', function() {
                newLayer.remove();
                // Renumber the layers
                document.querySelectorAll('.soil-layer').forEach((layer, index) => {
                    layer.querySelector('h4').textContent = `‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà ${index + 1}`;
                });
            });
            
            // Sync color picker with text input
            const colorPicker = newLayer.querySelector(`input[name="soilColorPicker${layerCount}"]`);
            const colorText = newLayer.querySelector(`input[name="soilColor${layerCount}"]`);
            
            colorPicker.addEventListener('input', () => {
                colorText.value = colorPicker.value;
            });
            
            colorText.addEventListener('input', () => {
                // Only update if it's a valid color format
                if (/^#[0-9A-F]{6}$/i.test(colorText.value)) {
                    colorPicker.value = colorText.value;
                }
            });
        }

        // Toggle between data formats
        function toggleDataFormat(format) {
            currentDataFormat = format;
            if (format === 'borehole') {
                document.getElementById('groundwaterForm').classList.remove('hidden');
                document.getElementById('locationForm').classList.add('hidden');
            } else {
                document.getElementById('groundwaterForm').classList.add('hidden');
                document.getElementById('locationForm').classList.remove('hidden');
            }
        }

        // Generate CSV data from form
        function generateCSV() {
            if (currentDataFormat === 'borehole') {
                return generateBoreholeCSV();
            } else {
                return generateLocationCSV();
            }
        }
        
        // Generate CSV for borehole data
        function generateBoreholeCSV() {
            // Collect form data
            const form = document.getElementById('groundwaterForm');
            const formData = new FormData(form);
            const layerCount = document.querySelectorAll('#groundwaterForm .soil-layer').length;
            
            // Basic validation
            const latitude = formData.get('latitude');
            const longitude = formData.get('longitude');
            const boreholeId = formData.get('boreholeId');
            
            if (!latitude || !longitude || !boreholeId) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏•‡∏∞‡∏ï‡∏¥‡∏à‡∏π‡∏î, ‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏à‡∏π‡∏î, ‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠) ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                return false;
            }
            
            // Prepare row for Google Sheets
            let rowData = [
                formData.get('latitude'),
                formData.get('longitude'),
                formData.get('boreholeId'),
                formData.get('totalDepth'),
                formData.get('waterLevel')
            ];
            
            // Add soil layer data
            for (let i = 1; i <= 4; i++) {
                if (i <= layerCount) {
                    rowData.push(
                        formData.get(`soilName${i}`) || '',
                        formData.get(`soilDepth${i}`) || '',
                        formData.get(`soilDesc${i}`) || '',
                        formData.get(`soilColor${i}`) || '',
                        formData.get(`soilPH${i}`) || ''
                    );
                } else {
                    // Add empty values for unused layers
                    rowData.push('', '', '', '', '');
                }
            }
            
            // Format as CSV row
            const csvRow = rowData.map(formatForCSV).join(',');
            document.getElementById('generatedData').value = csvRow;
            
            return true;
        }
        
        // Generate CSV for location data (task format)
        function generateLocationCSV() {
            // Collect form data
            const form = document.getElementById('locationForm');
            const formData = new FormData(form);
            
            // Basic validation
            const taskName = formData.get('taskName');
            
            if (!taskName) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô');
                return false;
            }
            
            // Prepare row for Google Sheets
            let rowData = [
                formData.get('taskName'), // ‡∏á‡∏≤‡∏ô (A)
                formData.get('priority') || 'P3', // ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (B)
                formData.get('owner') || '', // ‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á (C)
                formData.get('taskStatus') || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°', // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (D)
                formData.get('startDate') || '', // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (E)
                formData.get('endDate') || '', // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î (F)
                formData.get('reason') || '', // ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (G)
                '', // File placeholder (H)
                formData.get('notes') || '' // ‡πÇ‡∏ô‡πâ‡∏ï (I)
            ];
            
            // Format as CSV row
            const csvRow = rowData.map(formatForCSV).join(',');
            document.getElementById('generatedData').value = csvRow;
            
            return true;
        }
        
        // Copy CSV data to clipboard
        function copyCSV() {
            const textarea = document.getElementById('generatedData');
            if (!textarea.value) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å');
                return;
            }
            
            textarea.select();
            document.execCommand('copy');
            
            alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô Google Sheet ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢');
        }
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('addLayer').addEventListener('click', addSoilLayer);
            document.getElementById('generateCSV').addEventListener('click', generateCSV);
            document.getElementById('copyCSV').addEventListener('click', copyCSV);
            
            // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            document.getElementById('selectBoreholeFormat').addEventListener('click', function() {
                toggleDataFormat('borehole');
                this.classList.remove('bg-gray-200', 'text-gray-800');
                this.classList.add('bg-blue-500', 'text-white');
                document.getElementById('selectLocationFormat').classList.remove('bg-blue-500', 'text-white');
                document.getElementById('selectLocationFormat').classList.add('bg-gray-200', 'text-gray-800');
            });
            
            document.getElementById('selectLocationFormat').addEventListener('click', function() {
                toggleDataFormat('location');
                this.classList.remove('bg-gray-200', 'text-gray-800');
                this.classList.add('bg-blue-500', 'text-white');
                document.getElementById('selectBoreholeFormat').classList.remove('bg-blue-500', 'text-white');
                document.getElementById('selectBoreholeFormat').classList.add('bg-gray-200', 'text-gray-800');
            });
            
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î Google Sheet
            document.getElementById('copyAndOpenSheet').addEventListener('click', function() {
                const textarea = document.getElementById('generatedData');
                if (!textarea.value) {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏î‡∏¢‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheet"');
                    return;
                }
                
                // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                textarea.select();
                document.execCommand('copy');
                
                // ‡πÄ‡∏õ‡∏¥‡∏î Google Sheet ‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà
                window.open('https://docs.google.com/spreadsheets/d/1rHFWxtgQ47Npi9rMDoYjvXAzpr5F8jfu4L3RTa09a1Q/edit', '_blank');
                
                alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß Google Sheet ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Ctrl+V ‡∏´‡∏£‡∏∑‡∏≠ Command+V)');
            });
            
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
            async function checkExistingBoreholes() {
                const csvUrl = document.getElementById('generatedData').getAttribute('data-sheet-url') || '';
                const container = document.getElementById('existingBoreholeContainer');
                const boreholesList = document.getElementById('existingBoreholes');
                
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ URL ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡∏ô
                if (!csvUrl) {
                    boreholesList.innerHTML = '';
                    
                    // ‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                    const exampleBoreholes = [
                        'SRN-1001', 'SRN-1002', 'SRN-1027', 'SRN-1245', 
                        'NKT-0352', 'NKT-0353', 'NKT-0401',
                        'PCB-0012', 'PCB-0045', 'CMI-5501', 'KKN-1122'
                    ];
                    
                    exampleBoreholes.forEach(id => {
                        const span = document.createElement('span');
                        span.className = 'px-1 py-0.5 bg-gray-200 rounded text-gray-700';
                        span.textContent = id;
                        span.addEventListener('click', () => {
                            // ‡πÅ‡∏¢‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
                            const parts = id.split('-');
                            if (parts.length === 2) {
                                if (boreholeSeries.querySelector(`option[value="${parts[0]}"]`)) {
                                    boreholeSeries.value = parts[0];
                                    boreholePrefix.textContent = `${parts[0]}-`;
                                } else {
                                    boreholeSeries.value = 'custom';
                                    boreholePrefix.textContent = '';
                                }
                                boreholeNumber.value = parts[1];
                                updateBoreholeId();
                            }
                        });
                        boreholesList.appendChild(span);
                        
                        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏ó‡πá‡∏Å
                        boreholesList.appendChild(document.createTextNode(' '));
                    });
                    
                    container.classList.remove('hidden');
                    return;
                }
                
                // ‡πÅ‡∏™‡∏î‡∏á Loading
                boreholesList.innerHTML = '<div class="col-span-3 text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>';
                container.classList.remove('hidden');
                
                try {
                    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet CSV
                    const response = await fetch(csvUrl);
                    if (!response.ok) {
                        throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                    }
                    
                    const text = await response.text();
                    const rows = text.split('\n');
                    
                    // ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏û‡∏ö (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 3 ‡∏Ç‡∏≠‡∏á CSV)
                    const boreholeIds = [];
                    rows.forEach((row, index) => {
                        if (index === 0) return; // ‡∏Ç‡πâ‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
                        
                        const columns = row.split(',');
                        if (columns.length >= 3 && columns[2]) {
                            const id = columns[2].trim().replace(/^"|"$/g, ''); // ‡∏•‡∏ö quotes ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
                            if (id) boreholeIds.push(id);
                        }
                    });
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏û‡∏ö
                    boreholesList.innerHTML = '';
                    if (boreholeIds.length === 0) {
                        boreholesList.innerHTML = '<div class="col-span-3">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠</div>';
                    } else {
                        boreholeIds.forEach(id => {
                            const span = document.createElement('span');
                            span.className = 'px-1 py-0.5 bg-gray-200 rounded text-gray-700';
                            span.textContent = id;
                            span.addEventListener('click', () => {
                                // ‡πÅ‡∏¢‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ã‡∏µ‡∏£‡∏µ‡∏™‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
                                const parts = id.split('-');
                                if (parts.length === 2) {
                                    if (boreholeSeries.querySelector(`option[value="${parts[0]}"]`)) {
                                        boreholeSeries.value = parts[0];
                                        boreholePrefix.textContent = `${parts[0]}-`;
                                    } else {
                                        boreholeSeries.value = 'custom';
                                        boreholePrefix.textContent = '';
                                    }
                                    boreholeNumber.value = parts[1];
                                    updateBoreholeId();
                                }
                            });
                            boreholesList.appendChild(span);
                            
                            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏ó‡πá‡∏Å
                            boreholesList.appendChild(document.createTextNode(' '));
                        });
                    }
                } catch (error) {
                    console.error('Error fetching boreholes:', error);
                    boreholesList.innerHTML = '<div class="col-span-3">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ</div>';
                }
            }
            
            document.querySelector('input[name="soilName1"]').value = '‡∏î‡∏¥‡∏ô‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß';
            document.querySelector('input[name="soilDepth1"]').value = '0-8 ‡∏°.';
            document.querySelector('input[name="soilDesc1"]').value = '‡∏î‡∏¥‡∏ô‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÅ‡∏î‡∏á';
            document.querySelector('input[name="soilPH1"]').value = '6.5';
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô
            if (document.querySelector('#taskName')) {
                document.querySelector('#taskName').value = '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô';
                document.querySelector('#priority').value = 'P2';
                document.querySelector('#owner').value = '‡∏ó‡∏µ‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ô‡πâ‡∏≥';
                document.querySelector('#taskStatus').value = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£';
                
                // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ 30 ‡∏ß‡∏±‡∏ô
                const today = new Date();
                const thirtyDaysLater = new Date();
                thirtyDaysLater.setDate(today.getDate() + 30);
                
                // Format dates as YYYY-MM-DD
                document.querySelector('#startDate').value = today.toISOString().split('T')[0];
                document.querySelector('#endDate').value = thirtyDaysLater.toISOString().split('T')[0];
                
                document.querySelector('#reason').value = '‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô';
                document.querySelector('#notes').value = '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡πÄ‡∏Ç‡∏ï‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏µ‡πà ‡πÅ‡∏•‡∏∞‡∏à‡∏ï‡∏∏‡∏à‡∏±‡∏Å‡∏£';
            }
            
            // ‡πÇ‡∏´‡∏•‡∏î URL ‡∏à‡∏≤‡∏Å localStorage ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            const savedSheetUrl = localStorage.getItem('groundwater_sheet_url') || 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSn30i6fduRSszPNUwWskmwK8-KKunVtFfqGAyyFBAzXWJx5C0uz_6iLhai-F2rdwFOxlGMNdEU2uT_/pub?output=csv';
            if (savedSheetUrl) {
                sheetUrlInput.value = savedSheetUrl;
                generatedData.setAttribute('data-sheet-url', savedSheetUrl);
            }
            
            // ‡πÇ‡∏´‡∏•‡∏î URL ‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô‡∏à‡∏≤‡∏Å localStorage ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
            const savedSoilSheetUrl = localStorage.getItem('groundwater_soil_sheet_url') || 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSn30i6fduRSszPNUwWskmwK8-KKunVtFfqGAyyFBAzXWJx5C0uz_6iLhai-F2rdwFOxlGMNdEU2uT_/pub?gid=1083314165&single=true&output=csv';
            if (savedSoilSheetUrl) {
                soilSheetUrlInput.value = savedSoilSheetUrl;
            }
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            document.getElementById('saveSheetUrl').addEventListener('click', function() {
                const url = sheetUrlInput.value.trim();
                if (url) {
                    localStorage.setItem('groundwater_sheet_url', url);
                    generatedData.setAttribute('data-sheet-url', url);
                    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ö‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                    checkExistingBoreholes();
                } else {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Sheet CSV ‡∏´‡∏•‡∏±‡∏Å');
                }
            });
            
            // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö URL ‡∏Ç‡∏≠‡∏á Google Sheet CSV ‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô
            const soilSheetUrlInput = document.getElementById('soilSheetUrl');
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            document.getElementById('saveSoilSheetUrl').addEventListener('click', function() {
                const url = soilSheetUrlInput.value.trim();
                if (url) {
                    localStorage.setItem('groundwater_soil_sheet_url', url);
                    alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å URL ‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                } else {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Sheet CSV ‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô');
                }
            });
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
            document.getElementById('clearForm').addEventListener('click', function() {
                if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏¢‡∏π‡πà
                    if (currentDataFormat === 'borehole') {
                        document.getElementById('groundwaterForm').reset();
                        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                        setTimeout(() => {
                            document.querySelector('input[name="latitude"]').value = '';
                            document.querySelector('input[name="longitude"]').value = '';
                            document.querySelector('input[name="totalDepth"]').value = '';
                            document.querySelector('input[name="waterLevel"]').value = '';
                            document.querySelector('input[name="soilName1"]').value = '';
                            document.querySelector('input[name="soilDepth1"]').value = '';
                            document.querySelector('input[name="soilDesc1"]').value = '';
                            document.querySelector('input[name="soilPH1"]').value = '';
                            boreholeNumber.value = '';
                            updateBoreholeId();
                        }, 100);
                    } else {
                        document.getElementById('locationForm').reset();
                        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
                        setTimeout(() => {
                            document.querySelector('#taskName').value = '';
                            document.querySelector('#priority').value = 'P3';
                            document.querySelector('#owner').value = '';
                            document.querySelector('#taskStatus').value = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°';
                            document.querySelector('#startDate').value = '';
                            document.querySelector('#endDate').value = '';
                            document.querySelector('#reason').value = '';
                            document.querySelector('#notes').value = '';
                        }, 100);
                    }
                    
                    // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß
                    document.getElementById('generatedData').value = '';
                    
                    alert('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà');
                }
            });
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
            const addExampleButtons = () => {
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•
                const boreholeForm = document.getElementById('groundwaterForm');
                if (boreholeForm && !document.getElementById('exampleBoreholeBtn')) {
                    const exampleBtn = document.createElement('button');
                    exampleBtn.type = 'button';
                    exampleBtn.id = 'exampleBoreholeBtn';
                    exampleBtn.className = 'bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded';
                    exampleBtn.textContent = '‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á';
                    exampleBtn.onclick = fillBoreholeExample;
                    
                    const buttonContainer = boreholeForm.querySelector('.flex.justify-end.space-x-2');
                    buttonContainer.insertBefore(exampleBtn, buttonContainer.firstChild);
                }
                
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô
                const locationForm = document.getElementById('locationForm');
                if (locationForm && !document.getElementById('exampleLocationBtn')) {
                    const exampleBtn = document.createElement('button');
                    exampleBtn.type = 'button';
                    exampleBtn.id = 'exampleLocationBtn';
                    exampleBtn.className = 'bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded';
                    exampleBtn.textContent = '‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á';
                    exampleBtn.onclick = fillLocationExample;
                    
                    const buttonContainer = locationForm.querySelector('.flex.justify-end.space-x-2');
                    buttonContainer.insertBefore(exampleBtn, buttonContainer.firstChild);
                }
            };
            
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•
            const fillBoreholeExample = () => {
                const today = new Date();
                const lat = (13.7563 + (Math.random() - 0.5) * 0.1).toFixed(6); // Random around Bangkok
                const lon = (100.5018 + (Math.random() - 0.5) * 0.1).toFixed(6);
                const year = today.getFullYear();
                const randomNum = Math.floor(Math.random() * 1000) + 1;
                
                document.querySelector('input[name="latitude"]').value = lat;
                document.querySelector('input[name="longitude"]').value = lon;
                boreholeNumber.value = `${year}-${randomNum.toString().padStart(3, '0')}`;
                updateBoreholeId();
                document.querySelector('input[name="totalDepth"]').value = Math.floor(Math.random() * 50) + 20; // 20-70m
                document.querySelector('input[name="waterLevel"]').value = Math.floor(Math.random() * 30) + 10; // 10-40m
                
                document.querySelector('input[name="soilName1"]').value = '‡∏î‡∏¥‡∏ô‡∏£‡πà‡∏ß‡∏ô‡∏õ‡∏ô‡∏ó‡∏£‡∏≤‡∏¢';
                document.querySelector('input[name="soilDepth1"]').value = '0-8 ‡∏°.';
                document.querySelector('input[name="soilDesc1"]').value = '‡∏î‡∏¥‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏≠‡πà‡∏≠‡∏ô ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏î‡∏µ';
                document.querySelector('input[name="soilColor1"]').value = '#D4A574';
                document.querySelector('input[name="soilColorPicker1"]').value = '#D4A574';
                document.querySelector('input[name="soilPH1"]').value = '6.8';
            };
            
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏á‡∏≤‡∏ô
            const fillLocationExample = () => {
                const today = new Date();
                const nextMonth = new Date(today);
                nextMonth.setMonth(today.getMonth() + 1);
                
                const tasks = [
                    '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
                    '‡∏™‡∏≥‡∏£‡∏ß‡∏à‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•‡πÉ‡∏´‡∏°‡πà',
                    '‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡∏±‡∏î‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•',
                    '‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡∏ö‡πà‡∏≠‡∏ö‡∏≤‡∏î‡∏≤‡∏•',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°'
                ];
                
                const owners = ['‡∏ó‡∏µ‡∏°‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•', '‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û', '‡∏ó‡∏µ‡∏°‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà', '‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°'];
                const priorities = ['P0', 'P1', 'P2', 'P3'];
                const statuses = ['‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå'];
                
                const randomTask = tasks[Math.floor(Math.random() * tasks.length)];
                const randomOwner = owners[Math.floor(Math.random() * owners.length)];
                const randomPriority = priorities[Math.floor(Math.random() * priorities.length)];
                const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
                
                document.querySelector('#taskName').value = randomTask;
                document.querySelector('#priority').value = randomPriority;
                document.querySelector('#owner').value = randomOwner;
                document.querySelector('#taskStatus').value = randomStatus;
                document.querySelector('#startDate').value = today.toISOString().split('T')[0];
                document.querySelector('#endDate').value = nextMonth.toISOString().split('T')[0];
                document.querySelector('#reason').value = '‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ô‡πâ‡∏≥‡∏ö‡∏≤‡∏î‡∏≤‡∏•';
                document.querySelector('#notes').value = `‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£: ‡πÄ‡∏Ç‡∏ï‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£ - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ ${today.toLocaleDateString('th-TH')}`;
            };
            
            addExampleButtons();
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏•‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö
            const originalToggleDataFormat = toggleDataFormat;
            toggleDataFormat = function(format) {
                originalToggleDataFormat(format);
                setTimeout(addExampleButtons, 100); // ‡πÄ‡∏û‡∏¥‡πà‡∏° delay ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ DOM ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
            };
            
            // Show header banner
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' || window.location.protocol === 'file:') {
                const banner = document.createElement('div');
                banner.className = 'bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4';
                banner.innerHTML = `
                    <p class="font-bold">‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö</p>
                    <p>‡∏ô‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• CSV ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô Google Sheet ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
                `;
                document.querySelector('header').after(banner);
            }
        });
    </script>
</body>
</html>
